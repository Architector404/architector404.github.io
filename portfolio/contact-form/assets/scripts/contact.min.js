function Contact(e){let t,n,a,c,l,s,i,o,r,p,d,u,m,h,f,y,k,b,g,v,L,_,C,E,S,I,T,w,M,q;e.formPopup.set&&(w=document.querySelector(e.formPopup.btnSelector),M=document.querySelector(e.formPopup.formSelector),w.addEventListener("click",(function(){M.classList.add("popup-show")})),M.addEventListener("click",(function(t){const n=t.target;if(n.className!==e.formPopup.closeSelector&&n!==M)return!0;M.classList.remove("popup-show")}))),e.resultPopup.set&&(q=document.querySelector(e.resultPopup.selector),q.addEventListener("click",(function(t){const n=t.target;if(n.className!==e.resultPopup.closeSelector&&n!==q)return!0;q.classList.remove("popup-show"),I&&I.remove(),T&&T.remove()})));const H=document.querySelector(e.formContainerSelector),N=document.querySelector(e.resultContainerSelector),x=document.createElement("form");if(x.method="post",x.name="callback-form",x.className="callback-form",x.enctype="multipart/form-data",x.innerHTML="",H.appendChild(x),e.logo.set&&(t=document.createElement("img"),t.className="callback-form__logo",t.src=e.logo.src,x.appendChild(t)),e.title.set&&(n=document.createElement("span"),n.className="callback-form__title",n.innerHTML=e.title.text,x.appendChild(n)),e.nameInput.set&&(a=document.createElement("div"),a.className="callback-form__field",a.innerHTML='<i class="fas fa-user"></i>\n<input type="text" name="username" id="username" class="callback-form__input" placeholder="'+e.nameInput.placeholder+'" />\n<span class="warning" title="некорректные данные"><i class="fas fa-exclamation-triangle"></i></span>',x.appendChild(a),c=document.querySelector("#username"),c.addEventListener("input",(function(e){Z(e.target)?A(a,!0):A(a,!1)}))),e.phoneInput.set&&e.emailInput.set){const t=document.createElement("div");t.innerHTML='<label for="connect" class="callback-form__radio radio-container">Связаться по телефону\n<input type="radio" name="connect" id="connect" value="phone" checked/>\n<span class="radiomark"></span>\n</label>\n<label for="connect2" class="callback-form__radio radio-container">по e-mail\n<input type="radio" name="connect" id="connect2" value="phone" />\n<span class="radiomark"></span>\n</label>',x.appendChild(t),l=document.querySelector("#connect"),s=l.parentNode,i=document.querySelector("#connect2"),o=i.parentNode,document.addEventListener("DOMContentLoaded",(function(){z()})),s.addEventListener("click",(function(e){z()})),o.addEventListener("click",(function(t){r.style.display="none",d.style.display="block",P.innerHTML=e.buttonText.alt,h.style.display="none",y.style.display="none",k.style.display="none"}))}if(e.phoneInput.set&&(r=document.createElement("div"),r.className="callback-form__field",r.innerHTML='<i class="fas fa-phone"></i>\n<input type="text" name="phonenum" id="phonenum" class="callback-form__input" placeholder="'+e.phoneInput.placeholder+'" />\n<span class="warning" title="некорректные данные"><i class="fas fa-exclamation-triangle"></i></span>',x.appendChild(r),p=document.querySelector("#phonenum"),e.phoneInput.mask&&$("#phonenum").mask(e.phoneInput.mask,{completed:function(){A(r,!0)}}),p.addEventListener("input",(function(e){B(e.target)?A(r,!0):A(r,!1)}))),e.emailInput.set&&(d=document.createElement("div"),d.className="callback-form__field",d.innerHTML='<i class="fas fa-envelope"></i>\n<input type="email" name="email" id="email" class="callback-form__input" placeholder="'+e.emailInput.placeholder+'">\n<span class="warning" title="некорректные данные"><i class="fas fa-exclamation-triangle"></i></span>',x.appendChild(d),u=document.querySelector("#email"),u.addEventListener("input",(function(e){F(e.target)?A(d,!0):A(d,!1)}))),e.timeChose){const e=document.createElement("div");e.innerHTML='<label for="immediately" class="callback-form__radio radio-container">Позвонить сейчас\n<input type="radio" name="when" id="immediately" value="immediately" checked/>\n<span class="radiomark"></span>\n</label>\n<label for="bythetime" class="callback-form__radio radio-container">Выбрать время\n<input type="radio" name="when" id="bythetime" value="bythetime" />\n<span class="radiomark"></span>\n</label>\n<input type="time" name="time" class="callback-form__time" id="time-field">',x.appendChild(e),m=document.querySelector("#immediately"),h=m.parentNode,f=document.querySelector("#bythetime"),y=f.parentNode,k=document.querySelector("#time-field"),h.addEventListener("click",(function(e){k.style.display="none"})),y.addEventListener("click",(function(e){k.style.display="block"}))}if(e.messageInput.set&&(b=document.createElement("div"),b.className="callback-form__field",b.innerHTML='<textarea name="message" id="message" class="callback-form__area callback-form__input" placeholder="'+e.messageInput.placeholder+'"></textarea>\n<span class="warning" title="некорректные данные"><i class="fas fa-exclamation-triangle"></i></span>\n<span class="callback-form__count" id="count"><span id="count-number">0</span> / <span id="count-per">0</span></span>',x.appendChild(b),g=document.querySelector("#message"),document.getElementById("count-per").innerHTML=e.messageInput.limit,g.addEventListener("input",(function(t){O(t.target)?A(b,!0):A(b,!1),document.getElementById("count-number").innerHTML=this.value.length,this.value.length>=e.messageInput.limit&&(this.value=this.value.substr(0,e.messageInput.limit-1))}))),e.fileAttach.set&&(v=document.createElement("div"),v.className="callback-form__attach attach",v.innerHTML='<button type="button" class="attach__btn" id="attach-btn">'+e.fileAttach.text+'</button>\n<input type="file" name="attach" id="attach" accept="'+e.fileAttach.accept+'">',x.appendChild(v),L=document.querySelector("#attach"),_=document.querySelector("#attach-btn"),_.addEventListener("click",(function(e){L.click()})),L.addEventListener("change",(function(e){!function(){let e=L.files[0],t=new FileReader;t.onload=function(t){let n=e.name.slice(0,30);n.length<e.name.length&&(n+="..."),function(e){e='<i class="fas fa-paperclip"></i> '+e,document.querySelector("#attach-btn").innerHTML=e,document.querySelector("#attach-btn").classList.add("attached")}(n)},t.readAsDataURL(e)}()}))),e.recaptcha.set&&(C=document.createElement("div"),C.className="g-recaptcha",C.id="recaptcha",C.dataset.sitekey=e.recaptcha.sitekey,C.innerHTML="",x.appendChild(C)),e.policyCheck.set){const t=document.createElement("div");e.policyCheck.withCheck?t.innerHTML='<label for="personal" class="check-container" id="policy">'+e.policyCheck.text+'\n<input type="checkbox" name="personal" id="personal" class="personal" />\n<span class="checkmark"></span>\n</label>':t.innerHTML='<label for="personal" class="check-container" id="policy">'+e.policyCheck.text+"</label>",x.appendChild(t),e.policyCheck.withCheck&&(E=document.querySelector("#personal"))}const P=document.createElement("button");function A(e,t){t?(e.classList.remove("incorrect"),e.classList.add("correct"),"DIV"===e.tagName&&(e.querySelector(".warning").style.display="none")):(e.classList.remove("correct"),e.classList.add("incorrect"),"DIV"===e.tagName&&(e.querySelector(".warning").style.display="inline-block"))}function D(e){e?P.classList.remove("disabled"):P.classList.add("disabled")}function z(){d.style.display="none",r.style.display="block",P.innerHTML=e.buttonText.basic,h.style.display="inline-block",y.style.display="inline-block",h.click()}function R(t){S.remove(),t?(I=document.createElement("div"),I.className="form-result",I.innerHTML='<img src="'+e.resultIcon.success+'" alt="success" class="form-result__icon">\n<span class="form-result__title">'+e.resultText.success+"</span>\n",N.appendChild(I)):(T=document.createElement("div"),T.className="form-result",T.innerHTML='<img src="'+e.resultIcon.error+'" alt="error" class="form-result__icon">\n<span class="form-result__title">'+e.resultText.error+"</span>\n",N.appendChild(T))}function Z(e){let t=e.value.trim();let n=t.match(/^[a-zA-Zа-яА-ЯёЁ\s\-]*$/);return!(0===t.length||!n)}function B(e){let t=e.value.trim();let n=t.match(/^[0-9()\s\-+]*$/);return!(0===t.length||!n)}function F(e){let t=e.value.trim();let n=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(t).toLowerCase());return!(0===t.length||!n)}function O(e){return 0!==e.value.trim().length}function V(t){if(e.nameInput.set&&!Z(c))return A(a,!1),!1;if(e.phoneInput.set&&e.emailInput.set){if(l.checked&&!B(p))return A(r,!1),!1;if(i.checked&&!F(u))return A(d,!1),!1}else if(e.phoneInput.set&&!e.emailInput.set){if(!B(p))return A(r,!1),!1}else{if(!e.emailInput.set||e.phoneInput.set)return console.log("Включите в настройках хотя бы один из способов связи!"),!1;if(!F(u))return A(d,!1),!1}if(e.messageInput.set&&!O(g))return A(b,!1),!1;if(e.timeChose&&f.checked&&0===k.value.length)return A(k,!1),!1;if(e.recaptcha.set){if(0==grecaptcha.getResponse().length)return n=!1,C.style.border=n?"none":"1px solid red",!1}var n;return!0}async function j(t){e.formPopup.set&&M.classList.remove("popup-show"),e.resultPopup&&(q.classList.add("popup-show"),S=document.createElement("div"),S.className="preloader",S.innerHTML='<img src="assets/img/spinner.gif" alt="please wait" class="form-result__icon">',N.appendChild(S)),await fetch("php/sendmail.php",{method:"POST",body:new FormData(x)}).then(e=>{if(e.ok)return e.json();throw new Error("Something went wrong")}).then((function(e){"success"===e.status?R(!0):(R(!1),console.log(e.reason))})).catch(e=>{console.log(e),R(!1)})}P.type="button",P.name="send",P.id="send",P.className="btn callback-form__send",P.innerHTML=e.buttonText.basic,x.appendChild(P),P.addEventListener("click",(function(t){e.policyCheck.withCheck?E.checked&&V()?j():t.preventDefault():V()?j():t.preventDefault()})),e.policyCheck.set&&e.policyCheck.withCheck&&(D(!1),E.addEventListener("change",(function(e){E.checked?D(!0):D(!1)})))}